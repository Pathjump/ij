{% extends '::base.html.twig' %}

{% block stylesheets %}
<link href="{{asset('css/tabs-accordion.css')}}" type="text/css" rel="stylesheet" />
<link href="{{ asset('css/chosen.css') }}" rel="stylesheet" type="text/css"/>
{% endblock %}

{%block body%}

<section id="comJobList">
<div class="wrapper">

<aside class="others">


        <aside class="comJobListAccTabs">

            <div class="accTabs">
                <h1>Company Jobs</h1>
<!--Accordion Tabs-->
<div id="accordion">
{%if companyUsers%}
{%set job =""%}
{%for cu in companyUsers%}
        {%if cu.internship.id != job%}
        <h2 {% if loop.first %}class="current"{% endif %}>{{cu.internship.title}}</h2>
        {%set job =cu.internship.id %}
        <div class="pane" {% if loop.first %}style="display:block"{% endif %}>
            <ul>
        {%for u in companyUsers%}
            {%if cu.internship.title == u.internship.title%}
                <li><img src="{{u.user.getTimThumbUrl(111,119)}}" width="111" height="119">
                    <a href="{{path('company_user_task',{'userName' : u.user.loginName})}}">
                        {{u.user}}
                    </a>
            </li>
            {%endif%}
        {%endfor%}
             </ul>
        </div>
        {%endif%}

{%endfor%}
{%endif%}
</div>
<!--Accordion Tabs-->
</div>
</aside>

         {#       <div id="accordion">
                    {% for jobName in companyUsers %}

                        <h2 {% if loop.first %}class="current"{% endif %}>{{jobName}}</h2>
                        <div class="pane" {% if loop.first %}style="display:block"{% endif %}>
                            <ul>
                            {% for job in companyHiredUsers %}
                                {% if job.internship.title == jobName %}
                                    <li><img src="{{job.user.getTimThumbUrl(111,119)}}" width="111" height="119">
                                        <a href="{{path('company_user_task',{'userName' : job.user.loginName})}}">
{{job.user}}
                                            </a>
                                        </li>
                                {% endif %}
                            {% endfor %}
                                    </ul>
                                </div>

                    {% endfor %}

                            </div>
                      </div>#}
</aside>

<section class="comntSection" id="portalHome">

<aside class="addEdiTask">
<h1>Manage interns</h1>
<div class="userData">
<img src="{{ user.getTimThumbUrl(111, 119) }}" width="111" height="119">

<div class="info">
<h2>{{ user }}</h2>
<span><strong>Date of work:</strong>{{hireDate|date('Y-m-d')}}</span>
<span><strong>Tasks number:</strong> {{numOfTasks}}</span>
</div>

<div class="btns">
<a href="{{ path('task_new') }}" class="addTask">Add Task</a>
<a href="{{path('company_new_message', {'usename': user.loginName})}}" class="sndMsg">Send Message</a>
</div>
</div>

</aside>

<section class="comntSection" id="crntHired">
<aside class="copmanyInfo" id="msgsBox">

<div class="wrapper">

<div class="inboxBlock">

<div class="simpleTabsContent" style="display: block;">
<button type="submit"><img src="{{asset('img/taskList.png')}}" width="28" height="16"></button>

                              <div class="perPage">
                                    <span>Filter :</span>
                                    <select class="chzn-select" id="statusFilter">
                                        <option value=""></option>
                                        <option {%if status=="new"%}selected="selected"{%endif%}>new</option>
                                        <option {%if status=="inprogress"%}selected="selected"{%endif%}>inprogress</option>
                                        <option {%if status=="done"%}selected="selected"{%endif%}>done</option>
                                        <option {%if status=="all"%}selected="selected"{%endif%}>all</option>
                                    </select>
                                </div>


                                <div class="perPage" id="perpageFilter">
                                    <span>Per page :</span>
                                    <select  class="chzn-select" id="perpageFilter" tabindex="2" name="tasks_per_comp_show_page_{{ company.id }}" onchange="setCookie('tasks_per_comp_show_page_{{ company.id }}', this.value, 86391359);document.location.reload(true);">
                                        {% for perPageNumber in 10 .. 100 %}
                                            {% if perPageNumber is divisibleby(10) %}
                                                <option{% if tasksPerPage == perPageNumber %} selected="selected"{% endif %} value="{{ perPageNumber }}">{{ perPageNumber }}</option>
                                            {% endif %}
                                        {% endfor %}
                                    </select>
                                </div>

                                <div class="perPage">
                                    <span>Page :</span>
                                    <select class="chzn-select" id="pageFilter" tabindex="2">
                                        {% for pageNumber in 1 .. lastPageNumber %}
                                            <option{% if page == pageNumber %} selected="selected"{% endif %} value="{{ pageNumber }}">{{ pageNumber }}</option>
                                        {% endfor %}
                                      </select>
                                    </div>

<table class="msgsTable">
  <thead>

    <td>&nbsp;</td>
    <td>Task Name</td>
    <td>Date</td>
    <td>Task Case</td>
    <td>Show Task</td>
  </thead>
  {% if entities %}
  {% for entity in entities %}
  <tr{% if entity.status == 'new' %} class="read"{% endif %}>
      <td>&nbsp;</td>
      <td><a href="{{ path('company_task_show', { 'id': entity.id }) }}">{{ entity.title }}</a></td>
      <td><a href="{{ path('company_task_show', { 'id': entity.id }) }}"></a></td>
      <td class="case"><a href="{{ path('company_task_show', { 'id': entity.id }) }}"><span class="{% if entity.status == 'new' %}new{% elseif entity.status == 'inprogress' %}inprog{% else %}done{% endif %}"></span>{% if entity.status == 'new' %}New{% elseif entity.status == 'inprogress' %}Inprogress{% else %}Done{% endif %}</a></td>
      <td class="showTask"><a onclick="$('#Task_{{ entity.id }}_description').toggle();" href="javascript:void(0)">showTask</a></td>
  </tr>
  <tr style="display: none;" id="Task_{{ entity.id }}_description">
      <td colspan="5" class="taskDetails">
                                            {{ entity.description }}
          </td>
      </tr>
  {%endfor%}
  {%endif%}
</table>

<ul class="pging">
                                {% if lastPageNumber > 1 %}
                    {% if page > 1 %}
        <li><a href="{{ url('company_user_task', {'userName': user.loginname, 'status':status}) }}">&laquo;&laquo;</a></li>
        <li><a href="{{ url('company_user_task',{'userName': user.loginname,'status':status, 'page': page - 1}) }}">&laquo;</a></li>
                    {% endif %}



        {% for numberOfPage in 1..lastPageNumber %}
        {% if numberOfPage > page - 3 and numberOfPage < page + 3 %}
                                {% if page == numberOfPage %}<li class="crnt"><a href="javascript:void(0)">{{ numberOfPage }}</a></li>{% else %}<li><a href="{{ url('company_user_task',{'userName': user.loginname,'status':status, 'page': numberOfPage}) }}" >{{ numberOfPage }}</a></li>{%endif%}
        {% endif %}
        {% endfor %}



                    {% if page < lastPageNumber %}
        <li><a href="{{ url('company_user_task',{'userName': user.loginname ,'status':status,'page': page + 1}) }}" >&raquo;</a></li>
        <li><a href="{{ url('company_user_task',{'userName': user.loginname,'status':status, 'page': lastPageNumber}) }}" >&raquo;&raquo;</a></li>
{% endif %}
                {% endif %}
    </ul>




</div>
</div>

</aside>
</section>



</section>
</div>
</section>

{#

<h1>User Task list</h1>

<table class="records_list" border="1">
    <thead>
        <tr>
            <th>Id</th>
            <th>Title</th>
            <th>Description</th>
            <th>Status</th>
            <th>Startedat</th>
            <th>Endedat</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
    <img src="{{asset('img/userThumb.png')}}">
    <br />
    [[{{user.id}}]]<h4>{{user.loginname}}</h4> {{user.firstName}} || {{user.lastName}} || {{user.about}} || {{user.gender}}
    <hr>
    {% for entity in entities %}
        <tr>
            <td><a href="{{ path('company_task_show', { 'id': entity.id }) }}">{{ entity.id }}</a></td>
            <td>{{ entity.title }}</td>
            <td>{{ entity.description }}</td>
            <td>{{ entity.status }}</td>
           <td>{% if entity.createdAt %}{{ entity.createdAt|date('Y-m-d H:i:s') }}{% endif %}</td>
            <td>{% if entity.startedAt %}{{ entity.startedAt|date('Y-m-d H:i:s') }}{% endif %}</td>
            <td>{% if entity.endedAt %}{{ entity.endedAt|date('Y-m-d H:i:s') }}{% endif %}</td>
            <td>
                <ul>
                    <li>
                        <a href="{{ path('company_task_show', { 'id': entity.id }) }}">show</a>
                    </li>
                    <li>
                        <a href="{{ path('company_task_edit', { 'id': entity.id }) }}">edit</a>
                    </li>
                </ul>
            </td>
        </tr>
    {% endfor %}
    </tbody>
</table>

<ul>
    <li>
        <a href="{{ path('task_new') }}">
            Create a new entry
        </a>
    </li>
</ul>


    <ul class="pging">
                                {% if lastPageNumber > 1 %}
                    {% if page > 1 %}
                                                <li><a href="{{ url('company_user_task', {'userName': user.loginname ,'status': status}) }}">&raquo;&raquo;</a></li>
                                                <li><a href="{{ url('company_user_task',{'userName': user.loginname,'status': status, 'page': page - 1}) }}">&raquo;</a></li>
                    {% endif %}



        {% for numberOfPage in 1..lastPageNumber %}
        {% if numberOfPage > page - 3 and numberOfPage < page + 3 %}
                                {% if page == numberOfPage %}<li class="crnt"><a href="javascript:void(0)">{{ numberOfPage }}</a></li>{% else %}<li><a href="{{ url('company_user_task',{'userName': user.loginname,'status':status, 'page': numberOfPage}) }}" >{{ numberOfPage }}</a></li>{%endif%}
        {% endif %}
        {% endfor %}



                    {% if page < lastPageNumber %}
                                                <li><a href="{{ url('company_user_task',{'userName': user.loginname ,'status':status, 'page': page + 1}) }}" >&laquo;</a></li>
                                                <li><a href="{{ url('company_user_task',{'userName': user.loginname,'status':status, 'page': lastPageNumber}) }}" >&laquo;&laquo;</a></li>
{% endif %}
                {% endif %}
                                            </ul>
#}

{%endblock%}



{% block javascripts %}
{{parent()}}
<script src="{{ asset('js/libs/vtabs.js') }}" type="text/javascript"></script>

<script type="text/javascript" src="{{asset('js/libs/accTabs.js')}}"></script>

<script src="{{ asset('js/cookies.js') }}" type="text/javascript"></script>
<script>
                                                        $(function() {
                                                        $("#accordion").tabs(
                                                        "#accordion div.pane",
                                                        {tabs: 'h2', effect: 'slide', initialIndex: null}
                                                                );
                                                    });



       var companyUserTasksActionsUrl= '{{ path('company_user_task', {'userName': user.loginName,'status':'', 'page':''}) }}';
        $(document).ready(function(){
        $("select.chzn-select").chosen();

        $('#statusFilter').change(function(){
                 var status = $('#statusFilter option:selected').val();
                 window.location= companyUserTasksActionsUrl+status;
        });

        $('#pageFilter').change(function(){
                var page=$('#pageFilter option:selected').val();
                var status ='{{status}}';
                 window.location= companyUserTasksActionsUrl+status+"/"+page;
        });
    });


</script>
<script src="{{ asset('js/libs/chosen.jquery.min.js') }}" type="text/javascript"></script>
{%endblock%}