{% extends '::base.html.twig' %}
{% block title %}{{user}} notifications{% endblock %}

{% block stylesheets %}
<link href="{{ asset('css/chosen.css') }}" rel="stylesheet" type="text/css"/>
{% endblock %}

{% block body %}


<section id="msgsBox">
    <div class="wrapper">

        <div class="inboxBlock empNotfs">
            <div id="loading"><img src="{{asset('img/followLoader.gif')}}" width="35" height="35"></div>
            <!--Inbox Wrapper-->
            <h1>Notifications</h1>

            <div class="simpleTabsContent">
                {% if unreadNotifications|length > 0 and type == 'all' %}
                    <button type="submit" class="markAllUnreadNotification">Mark all as read</button>
                {% endif %}

                    <div class="perPage">
                        <span>Per page :</span>
                        <select  class="chzn-select" style="width: 65px !important;" tabindex="2" name="user_notifications_per_page_{{ user.id }}" onchange="setCookie('user_notifications_per_page_{{ user.id }}', this.value, 86391359);document.location.reload(true);">
                        {% for perPageNumber in 10 .. 100 %}
                            {% if perPageNumber is divisibleby(10) %}
                                <option{% if itemsPerPage == perPageNumber %} selected="selected"{% endif %} value="{{ perPageNumber }}">{{ perPageNumber }}</option>
                            {% endif %}
                        {% endfor %}
                            </select>
                        </div>

                        <div class="perPage">
                            <span>Page :</span>
                            <select class="chzn-select" style="width: 65px !important;" tabindex="2" onchange="window.location = '{{ path('User_notification', {'type': type,'page' : ''}) }}/' + this.value;">
                        {% for pageNumber in 1 .. lastPageNumber %}
                                    <option{% if page == pageNumber %} selected="selected"{% endif %} value="{{ pageNumber }}">{{ pageNumber }}</option>
                        {% endfor %}
                                </select>
                            </div>

                            <div class="perPage">
                                <span>Filter By :</span>
                                <select  class="chzn-select" tabindex="2" style="width: 150px !important;" onchange="window.location = '{{ path('User_notification', {'type': '','page' : ''}) }}' + this.value + '/' + {{page}};">
                                    <option {% if type == 'all' %}selected="selected"{% endif %} value="all">Show all</option>
                                    <option {% if type == 'company_question' %}selected="company_question"{% endif %} value="company_question">Company question</option>
                                    <option {% if type == 'company_interest' %}selected="company_interest"{% endif %} value="company_interest">Company interest</option>
                                    <option {% if type == 'company_job_hire' %}selected="company_job_hire"{% endif %} value="company_job_hire">Job offer</option>
                                    <option {% if type == 'company_interview' %}selected="company_interview"{% endif %} value="company_interview">Company interview</option>
                                    <option {% if type == 'company_edit_task' %}selected="company_edit_task"{% endif %} value="company_edit_task">Company update task</option>
                                    <option {% if type == 'company_add_note' %}selected="company_add_note"{% endif %} value="company_add_note">Company add task note</option>
                                    <option {% if type == 'company_assign_task' %}selected="company_assign_task"{% endif %} value="company_assign_task">Company assign task</option>
                                    <option {% if type == 'company_edit_note' %}selected="company_edit_note"{% endif %} value="company_edit_note">Company edit task note</option>
                                </select>
                            </div>

                            <div class="clearfix"></div>

                            <div class="notfsWrapper">
                    {% for notification in userNotifications %}
                        {% if notification.type == 'company_question' %}
                                    <div class="singleRow {% if notification.isNew %}active{% endif %}" notificationId='{{notification.id}}' notificationPage='{{path('question_show',{'questionId' : notification.typeId})}}'>
                                        <span class="icon answer"></span>
                                        <span class="from">{{notification.company}}</span>
                                        <span>has added a question for you</span>
                                        <span class="date">{{notification.createdAt|date('j F, Y')}}</span>
                                    </div>
                        {% elseif notification.type == 'company_interest' %}
                                    <div class="singleRow {% if notification.isNew %}active{% endif %}" notificationId='{{notification.id}}' notificationPage='{{path('user_interest',{'interestId' : notification.typeId})}}'>
                                        <span class="icon compInterest"></span>
                                        <span class="from">{{notification.company}}</span>
                                        <span>has indicated interest! Great Work!</span>
                                        <span class="date">{{notification.createdAt|date('j F, Y')}}</span>
                                    </div>
                        {% elseif notification.type == 'company_job_hire' %}
                                    <div class="singleRow {% if notification.isNew %}active{% endif %}" notificationId='{{notification.id}}' notificationPage='{{path('user_hire',{'userInternshipId' : notification.typeId})}}'>
                                        <span class="icon compHired"></span>
                                        <span class="from">{{notification.company}}</span>
                                        <span>has extended you an offer! Congratulations!</span>
                                        <span class="date">{{notification.createdAt|date('j F, Y')}}</span>
                                    </div>
                        {% elseif notification.type == 'company_interview' %}
                                    <div class="singleRow {% if notification.isNew %}active{% endif %}" notificationId='{{notification.id}}' notificationPage='{{path('user_interview',{'interviewId' : notification.typeId})}}'>
                                        <span class="icon compInterview"></span>
                                        <span class="from">{{notification.company}}</span>
                                        <span>has extended you an interview request! Congratulations!</span>
                                        <span class="date">{{notification.createdAt|date('j F, Y')}}</span>
                                    </div>
                        {% elseif notification.type == 'company_assign_task' %}
                                    <div class="singleRow {% if notification.isNew %}active{% endif %}" notificationId='{{notification.id}}' notificationPage='{{path('student_task_show',{'id' : notification.typeId})}}'>
                                        <span class="icon addTask"></span>
                                        <span class="from">{{notification.company}}</span>
                                        <span>has assigned you a task. Do not put it off too long!</span>
                                        <span class="date">{{notification.createdAt|date('j F, Y')}}</span>
                                    </div>
                        {% elseif notification.type == 'company_edit_task' %}
                                    <div class="singleRow {% if notification.isNew %}active{% endif %}" notificationId='{{notification.id}}' notificationPage='{{path('student_task_show',{'id' : notification.typeId})}}'>
                                        <span class="icon ediTask"></span>
                                        <span class="from">{{notification.company}}</span>
                                        <span>has edited your task. Check it out it might be important!</span>
                                        <span class="date">{{notification.createdAt|date('j F, Y')}}</span>
                                    </div>
                        {% elseif notification.type == 'company_add_note' %}
                                    <div class="singleRow {% if notification.isNew %}active{% endif %}" notificationId='{{notification.id}}' notificationPage='{{path('student_task_show',{'id' : notification.typeId})}}'>
                                        <span class="icon ediTask"></span>
                                        <span class="from">{{notification.company}}</span>
                                        <span>has added a note to your task. Check it out it might be important!</span>
                                        <span class="date">{{notification.createdAt|date('j F, Y')}}</span>
                                    </div>
                        {% elseif notification.type == 'company_edit_note' %}
                                    <div class="singleRow {% if notification.isNew %}active{% endif %}" notificationId='{{notification.id}}' notificationPage='{{path('student_task_show',{'id' : notification.typeId})}}'>
                                        <span class="icon ediTask"></span>
                                        <span class="from">{{notification.company}}</span>
                                        <span>has edited a note to your task. Check it out it might be important!</span>
                                        <span class="date">{{notification.createdAt|date('j F, Y')}}</span>
                                    </div>
                        {% endif %}
                    {% else %}
                                    You do not have notifications
                    {% endfor %}


                                </div>

                                <ul class="pging">
                    {% if lastPageNumber > 1 %}
                    {% if page > 1 %}
                                        <li><a href="{{ url('company_notification',{'type' : type }) }}" class="right">&laquo;&laquo;</a></li>
                                        <li><a href="{{ url('company_notification', { 'type' : type,'page': page - 1}) }}" class="right">&laquo;</a></li>
                    {% endif %}

        {% for numberOfPage in 1..lastPageNumber %}
        {% if numberOfPage > page - 3 and numberOfPage < page + 3 %}
                                {% if page == numberOfPage %}<li class="crnt">{{ numberOfPage }}</li>{% else %}<li><a href="{{ url('company_notification', {'type' : type,'page': numberOfPage}) }}">{{ numberOfPage }}</a></li>{%endif%}
        {% endif %}
        {% endfor %}


                    {% if page < lastPageNumber %}
                                        <li><a href="{{ url('company_notification', { 'type' : type,'page': page + 1}) }}" class="left">&raquo;</a></li>
                                        <li><a href="{{ url('company_notification', {'type' : type,'page': lastPageNumber}) }}" class="left">&raquo;&raquo;</a></li>
{% endif %}
                {% endif %}
                                    </ul>

                                </div>


                            </div>
                        </div>
                    </section>
{% endblock %}


{% block javascripts %}
{{parent()}}
                    <script>

                    var notficationMarkUrl = '{{path('user_notification_mardAs_read',{'notificationId': ''})}}';
                    var notficationMarkAllUrl = '{{path('user_mark_all_notifications_asRead')}}';

                        </script>

                        <script src="{{ asset('js/cookies.js') }}" type="text/javascript"></script>
                        <script src="{{ asset('js/libs/chosen.jquery.min.js') }}"></script>
                        <script src="{{asset('bundles/objectsinternjump/js/userNotifications.js')}}"></script>
{% endblock %}
